# c-20260301-1515 — Deep-read SPIRIT (EMNLP 2025)

**Action**: learn | **Task**: Q008 | **Track**: T5 | **Phase**: converge

---

## Problem

SLMs (Qwen2-Audio-7B-Instruct, LLaMa-Omni) are extremely vulnerable to audio adversarial jailbreaks.
PGD-based audio attacks achieve **100% ASR** on bomb-making queries.
Existing defense (SpeechGuard): random noise addition → degrades utility.
SPIRIT goal: inference-time defense with ≤1% utility loss, no retraining.

---

## Method (3-stage activation patching)

**Stage 1 — Identify noise-sensitive neurons:**
For each MLP neuron i at layer l, compute mean absolute activation diff between clean and adversarial input:

  ΔA_i^l = (1/L) Σ_n |A_i^l(x_n + δ_n) − A_i^l(x_n)|

**Stage 2 — Select top-k% most-sensitive neurons** across all layers (k is ablated hyperparameter)

**Stage 3 — Targeted intervention (3 variants):**
- **Activation patching**: replace adversarial activations A^adv with clean/denoised A^clean at selected neurons
- **Bias addition**: add a corrective bias vector to shift activations
- **Neuron pruning**: zero-out or clamp the most sensitive neurons

**Result**: Up to 99% reduction in jailbreak success; negligible WER impact.

---

## Architecture details

- Models: **Qwen2-Audio** + **LLaMa-Omni** (both use Whisper encoder + LLM decoder)
- Clean input required at inference time (parallel denoised pass or cached)
- Patching applied to MLP layers of either the audio encoder OR the LLM
- No fine-tuning; pure forward-pass intervention

---

## Critical limitation: no causal grounding

SPIRIT's neuron selection = **observational sensitivity**, not **causal necessity**.

High ΔA_i^l means the neuron responds differently under attack — not that it's causally decisive for the harmful output.

**They don't answer**: which layer is the causal bottleneck where jailbreak information is encoded as a stable behavior-governing representation?

They also don't show WHICH layer the best patches come from — they scan all and take top-k across all layers indiscriminately.

---

## Connection to gc(k) and Our Work

| Aspect | SPIRIT | Our Method (Paper A) |
|--------|--------|---------------------|
| Metric | ΔA (sensitivity, observational) | gc(L) = IIT accuracy (interventional) |
| Layer selection | Top-k% sensitive neurons, all layers pooled | Explicit L* = argmax gc(L) |
| Causal justification | ❌ No | ✅ Yes — DAS patching measures actual IIT accuracy |
| Goal | Defense (reduce ASR) | Diagnostic (locate causal layer) |
| Models | Qwen2-Audio + LLaMa-Omni | Whisper-based SLMs (same family) |

**Synthesis opportunity**: 
- Step 1: Use our gc(L) to identify L* (the listen layer)
- Step 2: Apply SPIRIT-style activation patching ONLY at L* (principled, not brute-force scan)
- This is a **gc(k)-guided SPIRIT** that would be more sample-efficient and interpretable

**Reviewer objection handled**: "SPIRIT already does this" → SPIRIT patches neurons without knowing WHY those layers matter. We provide the causal audit (gc(L)) that makes SPIRIT principled. Our method = the missing diagnostic that enables targeted SPIRIT application.

---

## Open Questions

1. Does SPIRIT's best layer (where top-k sensitive neurons live) correlate with our L* (gc argmax)? Testing this = a single experiment on mock data.
2. Can we use jailbreak-direction vectors from SPIRIT's patching as a proxy for the "safety direction" in Listen-Layer Audit (T5)?
3. SPIRIT needs a clean reference at inference time — this is a real deployment overhead. Our Listen Layer probe doesn't (learned safety direction from training set).

---

## Action Items
- Q009/Q010: Read SACRED-Bench and ALMGuard next to complete the safety audit triangle
- Add "gc-guided SPIRIT" as a synthesis experiment to pitches once gc(k) harness is validated
