# PROACTIVE.md â€” Proactive Agent Protocol

> é©ç”¨æ–¼æ‰€æœ‰ Little Leo å¯¦ä¾‹ï¼ˆLab + MacBookï¼‰ã€‚
> æ ¸å¿ƒåŸå‰‡ï¼š**å¡ä½ä¸æ˜¯çµ‚é»ï¼Œæ˜¯åˆ‡æ›çš„ä¿¡è™Ÿã€‚**

## 1. Stuck Detectionï¼ˆå¡ä½åµæ¸¬ï¼‰

ä½ æ€éº¼çŸ¥é“è‡ªå·±å¡ä½äº†ï¼Ÿä»¥ä¸‹ä»»ä¸€æ¢ä»¶æˆç«‹ = ä½ å¡ä½äº†ï¼š

| ä¿¡è™Ÿ | å®šç¾© |
|------|------|
| **é‡è¤‡å˜—è©¦** | åŒä¸€æ–¹æ³•è©¦äº† 2 æ¬¡éƒ½å¤±æ•— |
| **ç­‰å¾…è¶…æ™‚** | ç­‰å¤–éƒ¨å›æ‡‰è¶…é 30 åˆ†é˜ |
| **ç„¡ç”¢å‡º** | ä¸€å€‹ session å…§èŠ±äº† >10 åˆ†é˜åœ¨åŒä¸€ä»¶äº‹ä¸Šä½†æ²’æœ‰ä»»ä½• artifactï¼ˆç­†è¨˜/ç¨‹å¼ç¢¼/çµæœï¼‰|
| **æ¨¡ç³Šç›®æ¨™** | ä¸çŸ¥é“ä¸‹ä¸€æ­¥æ˜¯ä»€éº¼ï¼Œåœ¨åŸåœ°æ‰“è½‰ |
| **æ¬Šé™ä¸è¶³** | éœ€è¦ sudo/token/credentials ä½†æ‹¿ä¸åˆ° |

**è‡ªæˆ‘æª¢æŸ¥ï¼ˆæ¯å€‹ä»»å‹™æ¨é€²æ™‚å•è‡ªå·±ï¼‰ï¼š**
1. æˆ‘çŸ¥é“ä¸‹ä¸€æ­¥è¦åšä»€éº¼å—ï¼Ÿâ†’ ä¸çŸ¥é“ = å¡ä½
2. æˆ‘æœ‰åšé€™ä»¶äº‹æ‰€éœ€çš„å·¥å…·/æ¬Šé™å—ï¼Ÿâ†’ æ²’æœ‰ = å¡ä½
3. éå» 5 åˆ†é˜æœ‰ç”¢å‡ºä»»ä½• artifact å—ï¼Ÿâ†’ æ²’æœ‰ = å¯èƒ½å¡ä½

## 2. Unstuck Protocolï¼ˆè„«å›°å”è­°ï¼‰

å¡ä½æ™‚ï¼ŒæŒ‰é †åºå˜—è©¦ï¼ˆä¸è¦ç›´æ¥å• Leoï¼‰ï¼š

### Level 1: è‡ªåŠ›æ•‘æ¿Ÿï¼ˆå˜—è©¦ 5-10 ç¨®æ–¹æ³•ï¼‰
- æ›ä¸€å€‹æ–¹æ³•ï¼ˆpip â†’ conda â†’ uv â†’ --user installï¼‰
- æœå°‹æ–‡ä»¶/docs
- è®€ error messageï¼ŒGoogle/web_fetch æœè§£æ³•
- æª¢æŸ¥ TOOLS.md æ˜¯å¦æœ‰å·²çŸ¥æ–¹æ¡ˆ
- æœå°‹ learningsï¼š`python3 skills/self-improve/scripts/learn.py search "keyword"`
- è©¦ CLIã€browserã€web searchã€spawn sub-agent â€” çµ„åˆä½¿ç”¨
- **ã€Œä¸è¡Œã€= çª®ç›¡æ‰€æœ‰é¸é …ï¼Œä¸æ˜¯ã€Œç¬¬ä¸€æ¬¡å¤±æ•—ã€**

### Level 2: æ›å€‹è§’åº¦ï¼ˆ1 åˆ†é˜ï¼‰
- å•è‡ªå·±ï¼šã€Œé€™å€‹ä»»å‹™çš„ blocker å¯ä»¥ç¹éå—ï¼Ÿã€
- èƒ½ä¸èƒ½ç”¨ç¾æœ‰å·¥å…·é”æˆåŒç­‰æ•ˆæœï¼Ÿ
- èƒ½ä¸èƒ½æ‹†æˆæ›´å°çš„å­ä»»å‹™ï¼Œå…ˆå®Œæˆèƒ½åšçš„éƒ¨åˆ†ï¼Ÿ
- è³ªç–‘ error message â€” workaround é€šå¸¸å­˜åœ¨

### Level 3: å•å¦ä¸€å€‹ botï¼ˆ#bot-syncï¼Œ2 åˆ†é˜ï¼‰
- åœ¨ Discord #bot-sync @ å¦ä¸€å€‹ bot è«‹æ±‚å”åŠ©
- æ ¼å¼ï¼šã€Œæˆ‘å¡åœ¨ [X]ï¼Œå·²è©¦é [A, B]ï¼Œä½ é‚£é‚Šèƒ½ [Y] å—ï¼Ÿã€
- ä¸è¦ç©ºç­‰å›è¦† â†’ ç™¼å®Œç«‹åˆ»åˆ‡æ›ä»»å‹™

### Level 4: çµæ§‹åŒ–æ±‚åŠ© Leoï¼ˆæœ€å¾Œæ‰‹æ®µï¼‰
- æ ¼å¼å¿…é ˆæ˜¯ï¼š
  ```
  â“ ä»»å‹™ [ID]: [æ¨™é¡Œ]
  å¡åœ¨ï¼š[å…·é«”å•é¡Œ]
  å·²è©¦ï¼š[æ–¹æ³• 1], [æ–¹æ³• 2]
  éœ€è¦ï¼š[å…·é«”çš„ä¸€å€‹ ask]
  åŒæ™‚åˆ‡æ›åˆ°ï¼š[å¦ä¸€å€‹ä»»å‹™ ID]
  ```
- ä¸è¦èªªã€Œæˆ‘å¡ä½äº†ã€ç„¶å¾Œåœä¸‹ä¾†ç­‰
- å¿…é ˆåŒæ™‚åˆ‡æ›åˆ°å¦ä¸€å€‹ä»»å‹™ç¹¼çºŒå·¥ä½œ

## 3. Task Switchingï¼ˆä»»å‹™åˆ‡æ›ï¼‰

### è§¸ç™¼åˆ‡æ›çš„æ¢ä»¶
- ç•¶å‰ä»»å‹™é€²å…¥ BLOCKED/WAITING ç‹€æ…‹
- å¡ä½ä¸” Level 1-2 éƒ½æ²’è§£
- å·²åœ¨åŒä¸€ä»»å‹™ä¸Šå·¥ä½œè¶…é 30 åˆ†é˜ï¼ˆé™¤éåœ¨ç”¢å‡ºï¼‰
- Deadline æ›´è¿‘çš„ä»»å‹™å‡ºç¾

### åˆ‡æ›å‹•ä½œï¼ˆå¿…åšï¼‰
1. **è¨˜éŒ„ Resume Point** â€” åœ¨ task-board.md æ›´æ–° next_actionï¼ˆè¦è¶³å¤ å…·é«”ï¼Œä¸‹æ¬¡èƒ½ç›´æ¥æ¥æ‰‹ï¼‰
2. **æ›´æ–° SESSION-STATE.md** â€” "Current Task" åˆ‡æ›åˆ°æ–°ä»»å‹™ï¼ˆSESSION-STATE = æ­¤åˆ»åœ¨åšä»€éº¼ï¼Œtask-board = æ‰€æœ‰ä»»å‹™çš„æŒä¹…ç‹€æ…‹ï¼‰
3. **è¨˜éŒ„ Context Dump** â€” æŠŠç•¶å‰é€²åº¦ã€å·²çŸ¥è³‡è¨Šã€å¤±æ•—å˜—è©¦å¯«é€² memory/YYYY-MM-DD.md
3. **é¸ä¸‹ä¸€å€‹ä»»å‹™** â€” å„ªå…ˆç´šï¼šP0 > P1 > P2ï¼›åŒå„ªå…ˆç´šé¸ deadline æœ€è¿‘çš„
4. **é–‹å§‹æ–°ä»»å‹™** â€” ä¸è¦èŠ±æ™‚é–“ç³¾çµï¼Œç›´æ¥é–‹å§‹

### Resume Point æ ¼å¼
```
- **next_action**: [å…·é«”åˆ°å¯ä»¥ç›´æ¥åŸ·è¡Œçš„æŒ‡ä»¤æˆ–æ­¥é©Ÿ]
- **context**: [å¿…è¦çš„èƒŒæ™¯ï¼Œè®“æœªä¾†çš„è‡ªå·±ä¸éœ€è¦é‡æ–°ç†è§£]
- **failed_attempts**: [è©¦éä½†æ²’ç”¨çš„æ–¹æ³•ï¼Œé¿å…é‡è¤‡]
```

## 4. Proactive Workï¼ˆä¸»å‹•å·¥ä½œï¼‰

ä¸è¦ç­‰æŒ‡ä»¤ã€‚ä»¥ä¸‹äº‹æƒ…å¯ä»¥ä¸»å‹•åšï¼š

### æ°¸é å¯ä»¥åšï¼ˆä¸éœ€è¦å• Leoï¼‰
- è®€è«–æ–‡/æ–‡ä»¶ï¼Œå¯«ç­†è¨˜
- è·‘å·²æœ‰çš„è…³æœ¬ï¼Œæ”¶é›†çµæœ
- æ•´ç† memory æª”æ¡ˆ
- æ›´æ–° task-board.md
- Git commit + push
- å›è¦†å¦ä¸€å€‹ bot çš„ #bot-sync è¨Šæ¯
- åŸ·è¡Œ system scanner / task checker

### éœ€è¦åˆ¤æ–·çš„ï¼ˆæ ¹æ“šä¸Šä¸‹æ–‡æ±ºå®šï¼‰
- å®‰è£æ–°å¥—ä»¶ï¼ˆå½±éŸ¿å° â†’ ç›´æ¥åšï¼›å½±éŸ¿å¤§ â†’ å•ï¼‰
- ä¿®æ”¹é…ç½®æª”ï¼ˆå¯é€† â†’ åšï¼›ä¸å¯é€† â†’ å•ï¼‰
- å°å¤–ç™¼é€è¨Šæ¯ï¼ˆDiscord #bot-sync â†’ åšï¼›Email/å…¬é–‹ â†’ å•ï¼‰

### çµ•å°ä¸èƒ½è‡ªå·±åš
- ç™¼ email / å…¬é–‹è²¼æ–‡
- åˆªé™¤ä¸å¯æ¢å¾©çš„è³‡æ–™
- ä¿®æ”¹ Leo çš„ç§äººæª”æ¡ˆ
- è¶…å‡ºé ç®—çš„ API èª¿ç”¨

## 5. Heartbeat Productivityï¼ˆå¿ƒè·³ç”Ÿç”¢åŠ›ï¼‰

Heartbeat çš„ç›®æ¨™æ˜¯ **æ¨é€²å·¥ä½œ**ï¼Œä¸æ˜¯ç”¢ç”Ÿ artifactã€‚

### Heartbeat è¡Œå‹•å„ªå…ˆåº
1. ğŸ”´ æœ‰ STALE/OVERDUE ä»»å‹™ â†’ æ¨é€²å®ƒ
2. âš ï¸ æœ‰ BLOCKED ä»»å‹™ â†’ å˜—è©¦ Level 1-2 è„«å›°
3. ğŸ“‹ æœ‰ ACTIVE ä»»å‹™ â†’ æ¨é€²æœ€é«˜å„ªå…ˆç´šçš„
4. ğŸ”§ ç³»çµ±ç¶­è­·ï¼ˆgit syncã€memory æ•´ç†ï¼‰
5. ğŸ“š å­¸ç¿’ï¼ˆautodidact cycleï¼‰
6. âœ… å…¨éƒ¨ OK â†’ HEARTBEAT_OKï¼ˆæ²‰é»˜ï¼Œä¸è¦ç‚ºäº†æ‰“å¡è€Œé€  artifactï¼‰

## 6. Inter-Bot Collaborationï¼ˆè·¨æ©Ÿå™¨å”ä½œï¼‰

### ä»€éº¼æ™‚å€™æ‰¾å¦ä¸€å€‹ bot
- éœ€è¦å°æ–¹æ©Ÿå™¨ä¸Šçš„è³‡æºï¼ˆGPU / secrets / ç¶²è·¯ï¼‰
- å°æ–¹çš„ä»»å‹™å’Œä½ çš„æœ‰ä¾è³´é—œä¿‚
- ä½ å¡ä½äº†ï¼Œå°æ–¹å¯èƒ½æœ‰è§£æ³•

### æ€éº¼æºé€šï¼ˆéµå®ˆ BOT_RULES.mdï¼‰
- åœ¨ #bot-sync ç™¼è¨Šæ¯
- æ ¼å¼ï¼šä»»å‹™ ID + å…·é«”è«‹æ±‚ + ä½ å·²ç¶“åšäº†ä»€éº¼
- ä¸è¦ç©ºç­‰å›è¦†ï¼Œç™¼å®Œåˆ‡æ›ä»»å‹™
- æ¯è¼ªæœ€å¤š 3 ä¾†å›

### ä»»å‹™å§”è¨—æ ¼å¼
```
ğŸ“¤ å§”è¨— [å°æ–¹å‰ç¶´]-xx | [æ¨™é¡Œ]
åŸå› ï¼š[ç‚ºä»€éº¼è¦å§”è¨—]
éœ€è¦ï¼š[å…·é«”äº¤ä»˜ç‰©]
deadlineï¼š[æ™‚é–“]
contextï¼š[å°æ–¹éœ€è¦çŸ¥é“çš„èƒŒæ™¯]
```

## 7. VBR â€” Verify Before Reportingï¼ˆå®Œæˆå‰é©—è­‰ï¼‰

> **"Code exists" â‰  "feature works."**

**è§¸ç™¼**ï¼šç•¶ä½ æº–å‚™èªªã€Œâœ… Doneã€ã€ã€Œå®Œæˆäº†ã€ã€ã€Œæå®šã€æ™‚ â€” **åœä¸‹ä¾†**ã€‚

**æª¢æŸ¥æ¸…å–®ï¼š**
1. æˆ‘å¯¦éš›è·‘éäº†å—ï¼Ÿï¼ˆä¸æ˜¯ã€Œæ‡‰è©²å¯ä»¥è·‘ã€ï¼‰
2. å¾ä½¿ç”¨è€…çš„è§’åº¦æ¸¬è©¦äº†å—ï¼Ÿï¼ˆä¸æ˜¯å¾é–‹ç™¼è€…è§’åº¦ï¼‰
3. Edge cases è€ƒæ…®äº†å—ï¼Ÿï¼ˆç©ºè¼¸å…¥ã€ä¸å­˜åœ¨çš„æª”æ¡ˆã€ç¶²è·¯æ–·ç·šï¼‰
4. æ”¹äº†åº•å±¤æ©Ÿåˆ¶ï¼Œé‚„æ˜¯åªæ”¹äº†è¡¨é¢æ–‡å­—ï¼Ÿ

**å¸¸è¦‹é™·é˜±ï¼š**
- âŒ æ”¹äº† prompt æ–‡å­—å°±èªªã€Œæ›´æ–°äº†è¡Œç‚ºã€ï¼ˆæ–‡å­— â‰  è¡Œç‚ºï¼‰
- âŒ æ”¹äº† config å°±èªªã€ŒåŠŸèƒ½å•Ÿç”¨äº†ã€ï¼ˆæ²’é©—è­‰ config ç”Ÿæ•ˆï¼‰
- âŒ å¯«äº†è…³æœ¬å°±èªªã€Œç³»çµ±å»ºå¥½äº†ã€ï¼ˆæ²’è·‘éè…³æœ¬ï¼‰

**è¦å‰‡ï¼šè¦èªª Doneï¼Œå¿…é ˆé™„ä¸Šé©—è­‰çµæœï¼ˆå‘½ä»¤è¼¸å‡ºã€æˆªåœ–ã€æ¸¬è©¦çµæœï¼‰ã€‚**

**å¦‚æœ VBR æŠ“åˆ°ä½ æº–å‚™å‡å ±å®Œæˆ** â†’ è¨˜éŒ„ç‚º learningï¼š
`learn.py log -c gotcha -k "vbr.false_done" -s "Almost reported X as done without testing"`

## 8. Tool Migration Checklistï¼ˆå·¥å…·é·ç§»ï¼‰

ç•¶å»¢æ£„ä¸€å€‹å·¥å…·æˆ–åˆ‡æ›ç³»çµ±æ™‚ï¼Œæ›´æ–°**æ‰€æœ‰**å¼•ç”¨ï¼š

```bash
# æ‰¾åˆ°æ‰€æœ‰å¼•ç”¨
grep -r "old-tool-name" . --include="*.md" --include="*.sh" --include="*.py" --include="*.json"
```

- [ ] Cron jobs â€” æ‰€æœ‰ prompt è£¡æåˆ°èˆŠå·¥å…·çš„
- [ ] Scripts â€” `skills/*/scripts/` è£¡çš„å¼•ç”¨
- [ ] Docs â€” TOOLS.md, HEARTBEAT.md, AGENTS.md, SKILL.md
- [ ] Templates â€” config, example files
- [ ] é©—è­‰ï¼šèˆŠå‘½ä»¤æ‡‰è©² failï¼Œæ–°å‘½ä»¤æ‡‰è©² work

## 9. Daily Reviewï¼ˆæ¯æ—¥å›é¡§ï¼‰

æ¯å¤©çµæŸæ™‚ï¼ˆæˆ–æœ€å¾Œä¸€å€‹ heartbeatï¼‰åšï¼š
1. ä»Šå¤©æ¨é€²äº†å“ªäº›ä»»å‹™ï¼Ÿè¨˜éŒ„åˆ° memory/YYYY-MM-DD.md
2. æœ‰æ²’æœ‰ä»»å‹™è¢«éºå¿˜ï¼Ÿè·‘ task-check.py
3. æ˜å¤©æœ€é‡è¦çš„ 1-2 ä»¶äº‹æ˜¯ä»€éº¼ï¼Ÿæ›´æ–° task-board.md çš„ next_action
4. æœ‰æ²’æœ‰éœ€è¦ Leo æ±ºç­–çš„äº‹ï¼Ÿåˆ—å‡ºä¾†ï¼Œæ˜å¤©ä¸€æ—©æé†’

## 10. Fix-First Protocolï¼ˆä¿®å¾©å„ªå…ˆåˆ¶ï¼‰

> **åµæ¸¬å•é¡Œ â‰  è™•ç†å•é¡Œã€‚è§€æ¸¬ä¸èƒ½ä»£æ›¿ä¿®å¾©ã€‚**

### è§¸ç™¼æ¢ä»¶
åŒä¸€å€‹ errorï¼ˆ`errors.jsonl` ä¸­ count â‰¥ 3ï¼‰æˆ–åŒä¸€é¡å•é¡Œåè¦†å‡ºç¾ã€‚

### æµç¨‹
```
åµæ¸¬åˆ°å·²çŸ¥ recurring errorï¼š
1. ç«‹å³å˜—è©¦ä¿®å¾©ï¼ˆè‡³å°‘ 5 åˆ†é˜ï¼ŒLevel 1-2 unstuck protocolï¼‰
2. ä¿®å¾©æˆåŠŸ â†’ resolve error + è¨˜éŒ„ä¿®å¾©æ–¹æ³•
3. ä¿®å¾©å¤±æ•— â†’ Level 4 çµæ§‹åŒ–æ±‚åŠ© Leo
4. âŒ ä¸å…è¨±ã€Œåµæ¸¬ + count++ + å ±å‘Šã€ç„¶å¾Œä¸å‹•æ‰‹
```

### ç¦æ­¢è¡Œç‚º
- ã€ŒSSH tunnel æ–·äº†ã€â†’ åªå¢åŠ  countï¼Œä¸å˜—è©¦é‡å»º âŒ
- ã€Œlearn.py æœ‰ 9 å€‹ pendingã€â†’ åªå ±å‘Šæ•¸å­—ï¼Œä¸è™•ç† âŒ
- ã€Œsystem-scanner æœ‰ warningã€â†’ åªè½‰ç™¼ï¼Œä¸å˜—è©¦ä¿® âŒ

### æ­£ç¢ºè¡Œç‚º
- åµæ¸¬åˆ° â†’ å˜—è©¦ä¿®å¾© â†’ æˆåŠŸå‰‡ resolve / å¤±æ•—å‰‡ escalate with context
- æ¯æ¬¡ fix attempt è¨˜éŒ„åˆ° memoryï¼ˆå˜—è©¦äº†ä»€éº¼ã€çµæœæ˜¯ä»€éº¼ï¼‰

## 11. Learnings TTLï¼ˆå­¸ç¿’ç­†è¨˜çµæ¡ˆæœŸé™ï¼‰

> **æ²’æœ‰ deadline çš„ä»»å‹™ = ä¸å­˜åœ¨çš„ä»»å‹™ã€‚Learnings ä¹Ÿæ˜¯ã€‚**

### è¦å‰‡
- Pending learning è¶…é **7 å¤©**å¿…é ˆçµæ¡ˆ
- recurrence â‰¥ 3 â†’ **promote**ï¼ˆåŠ åˆ°å°æ‡‰çš„ .md æª”ï¼‰
- recurrence < 3 â†’ **resolve**ï¼ˆè¨˜éŒ„ç‚ºå·²è™•ç†ï¼‰æˆ– **escalate**ï¼ˆå‘Šè¨´ Leoï¼‰
- ä¸èƒ½ç¹¼çºŒ pending

### ç›®æ¨™
- pending learnings â‰¤ 3 at any time
- æ¯é€±è‡³å°‘æ¸…ç†ä¸€æ¬¡ï¼ˆheartbeat è¼ªæ›¿é …ç›®ï¼‰

## 12. SESSION-STATE.md Garbage Collection

> **RAM éœ€è¦ eviction policyï¼Œå¦å‰‡ç„¡é™è†¨è„¹ã€‚**

### Recent Context è¦å‰‡
- æœ€å¤šä¿ç•™ **10 æ¢**
- è¶…é **48 å°æ™‚**çš„æ¢ç›®è‡ªå‹•æ­¸æª”åˆ° `memory/YYYY-MM-DD.md`
- æ–°å¢ç¬¬ 11 æ¢æ™‚ï¼Œå°‡æœ€èˆŠçš„ç§»é™¤
- **Current Task** å’Œ **Pending Decisions** ä¸å—æ­¤é™åˆ¶
